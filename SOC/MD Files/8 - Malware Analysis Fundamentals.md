# 1) How Malware Analysis Help SOC Analysts
* Stuxnet : is a highly sophisticated, malicious computer worm discovered in 2010, designed to 
sabotage Iran's nuclear program

![alt text](../Assets/lab8/1.1.png)

#### How many zero-day vulnerabilities exist in Stuxnet? (Answer should be string)
>**Answer: four**
#### Which company's industrial control systems is Stuxnet targeting?
>**Answer: Siemens**

# 2) Malware Definition and Malware Types
Malware: is a word derived from the words MALicious softWARE. It is the name given to software 
that endangers the security and integrity of systems by targeting a malicious purpose.

Malware Types:
* Backdoor: Leaving a backdoor on the device where the malware is installed, it allows the attacker 
to access the system through this backdoor. For example, by opening a network port connected to the shell, 
it enables the attacker to connect to the system through this port.
* Adware: It often comes with downloaded software, causing unwanted advertisements to be displayed on the device. 
While not all adware is harmful, some change the default search engine.
* Ransomware: It is a type of malware that has been on the world agenda for the last few years. It demands 
ransom from people by encrypting and exfiltrating all files on the device.
* Virus: It is one of the first types of malware seen in the wild. So we see that in daily life, it is often 
called a virus instead of the term malware. Viruses have a self-replicate feature. It provides persistence by 
infecting other files on the device.
* Worm: Since this type of malware spreads from infected devices to other devices, it is named worm. WannaCry, 
a worm malware exploiting MS17-010 vulnerability, caused panic around the world.
* Rootkit: It is a type of malware that disguises itself by providing access to a high level of authority on the device.
* RAT (Remote Access Trojan): It is a type of malware that provides full control over the device to the threat actor.
* Banking malware: A type of malware that targets banking applications and causes money to be stolen from the victim.
* Keylogger: A type of malware that logs pushed keys and sends this information to attacker.

#### What is the name of the first worm malware to spread on the internet?
>**ANSWER: Morris**
#### What is the vulnerability code of the vulnerability used by Wannacry?
>**ANSWER: MS17-010**
#### What is the name of the malware that was detected in December 2021, distributed through the Solarwinds Orion product and caused the hacking of many organizations such as FireEye?
>**ANSWER: SUNBURST**




# 3) What Should a Malware Analyst Know
#### What type of encryption do ransomware use?
>**ANSWER: ASymmetric**
#### What is the encryption type frequently used by ransomware-type malware?
>**ANSWER: AES**
#### What is the name of the software that compiles of the written codes?
>**ANSWER: compiler**
#### According to Wikipedia, in what year did assembly language first appear?
>**ANSWER: 1947**
#### What is the name of the software that translates machine code into assembly language?
>**ANSWER: disassembler**



# 4) Which Approach Should You Choose When Analyzing Malware?

There are 2 different approaches to analyzing malware.
1. Static Analysis : It is the approach of analyzing malicious software by reverse engineering methods without running them.
Generally, by decompile / disassemble the malware, each step that the malware will execute is analyzed, hence the behavior / capacity of the malware can be analyzed.

Your device will not be infected as you do not run malicious software in static analysis. (However, we do not recommend performing static analysis on your host device, it will be more proper to do your analysis in a virtual operating system.)

The information examined during the static analysis is as follows.
* P.E. (Portable Executable) Headers
* Imported DLL's
* Exported DLL's
* Strings in binary
* CPU Instructions

2. Dynamic Analysis : It is the approach that examines the behavior of malicious software on the system by running it.

In dynamic analysis, applications that can examine registry, file, network and process events are installed in the system, and their behavior is examined by running malicious software.

While doing dynamic analysis, you should carefully examine the following events.
* Network Connections
* File Events
* Process Events
* Registry Events

![alt text](../Assets/lab8/4.1.png)

# 5) Dynamic Analysis Example Using AnyRun

* Agent Tesla is a RAT (Remote access Trojan)
* smtp.godforeu.com is a Agent Tesla malicious SMTP server address.

![alt text](../Assets/lab8/5.1.png)

#### (Access AnyRun report to answer this question) What is the email address that the malware connects to the mail server to steal data?
>**ANSWER: logs@godforeu.com**

![alt text](../Assets/lab8/5.2.png)
this is the password now we should decode it !
#### (Access AnyRun report to answer this question) What is the password malware use while connecting to the mail server?
>**ANSWER: O8k#Pz4sk:w_**



# 6) 29 Addresses to Analyze Malware Faster
 
* We constantly spend time analyzing malware. We have listed 29 addresses that can be useful for blue team members to use time more effectively:

<ul>
<li><a aria-label="undefined (opens in a new tab)" href="https://sandbox.anlyz.io" target="_blank" rel="noreferrer noopener" style="color:#0099FF;" >Anlyz </a></li>
<li><a aria-label="undefined (opens in a new tab)" href="https://app.any.run" target="_blank" rel="noreferrer noopener" style="color:#0099FF;" >Any.run </a></li>
<li><a href="https://valkyrie.comodo.com" style="color:#0099FF;" >Comodo Valkyrie</a></li>
<li><a href="https://sandbox.pikker.ee/" target="_blank" rel="noreferrer noopener" style="color:#0099FF;" >Cuckoo</a></li>
<li><a aria-label="undefined (opens in a new tab)" href="http://www.hybrid-analysis.com/" target="_blank" rel="noreferrer noopener" style="color:#0099FF;" >Hybrid Analysis</a></li>
<li><a aria-label="undefined (opens in a new tab)" href="https://www.intezer.com" target="_blank" rel="noreferrer noopener" style="color:#0099FF;" >Intezer Analyze</a> </li>
<li><a aria-label="undefined (opens in a new tab)" href="https://www.secondwrite.com" target="_blank" rel="noreferrer noopener" style="color:#0099FF;" >SecondWrite Malware Deepview</a> </li>
<li><a aria-label="undefined (opens in a new tab)" href="http://jevereg.amnpardaz.com/" target="_blank" rel="noreferrer noopener" style="color:#0099FF;" >Jevereg</a> </li>
<li><a aria-label="undefined (opens in a new tab)" href="http://cloud.iobit.com" target="_blank" rel="noreferrer noopener" style="color:#0099FF;" >IObit Cloud</a> </li>
<li><a aria-label="undefined (opens in a new tab)" href="http://www.binaryguard.com" target="_blank" rel="noreferrer noopener" style="color:#0099FF;" >BinaryGuard</a></li>
<li><a aria-label="undefined (opens in a new tab)" href="http://bitblaze.cs.berkeley.edu/" target="_blank" rel="noreferrer noopener" style="color:#0099FF;" >BitBlaze</a></li>
<li><a aria-label="undefined (opens in a new tab)" href="http://sanddroid.xjtu.edu.cn" target="_blank" rel="noreferrer noopener" style="color:#0099FF;" >SandDroid </a></li>
<li><a aria-label="undefined (opens in a new tab)" href="https://www.joesandbox.com/#windows" target="_blank" rel="noreferrer noopener" style="color:#0099FF;" >Joe Sandbox</a> </li>
<li><a aria-label="undefined (opens in a new tab)" href="https://amaaas.com/" target="_blank" rel="noreferrer noopener" style="color:#0099FF;" >AMAaaS</a> </li>
<li><a aria-label="undefined (opens in a new tab)" href="https://iris-h.services/pages/dashboard#/pages/dashboard" target="_blank" rel="noreferrer noopener" style="color:#0099FF;" >IRIS-H</a> </li>
<li><a aria-label="undefined (opens in a new tab)" href="https://intelligence.gatewatcher.com/" target="_blank" rel="noreferrer noopener" style="color:#0099FF;" >Gatewatcher Intelligence</a> </li>
<li><a aria-label="undefined (opens in a new tab)" href="https://tria.ge/" target="_blank" rel="noreferrer noopener" style="color:#0099FF;" >Hatching Triage</a>&nbsp;</li>
<li><a aria-label="undefined (opens in a new tab)" href="https://labs.inquest.net/dfi" target="_blank" rel="noreferrer noopener" style="color:#0099FF;" >InQuest Labs</a></li>
<li><a aria-label="undefined (opens in a new tab)" href="https://manalyzer.org/" target="_blank" rel="noreferrer noopener" style="color:#0099FF;" >Manalyzer</a> </li>
<li><a aria-label="undefined (opens in a new tab)" href="https://threatpoint.checkpoint.com/ThreatPortal/emulation" target="_blank" rel="noreferrer noopener" style="color:#0099FF;" >SandBlast Analysis</a> </li>
<li><a aria-label="undefined (opens in a new tab)" href="https://app.sndbox.com/" target="_blank" rel="noreferrer noopener" style="color:#0099FF;" >SNDBOX </a></li>
<li><a aria-label="undefined (opens in a new tab)" href="http://firmware.re/" target="_blank" rel="noreferrer noopener" style="color:#0099FF;" >firmware </a></li>
<li><a aria-label="undefined (opens in a new tab)" href="https://metadefender.opswat.com/?lang=en" target="_blank" rel="noreferrer noopener" style="color:#0099FF;" >opswat</a> </li>
<li><a aria-label="undefined (opens in a new tab)" href="http://virusade.com/" target="_blank" rel="noreferrer noopener" style="color:#0099FF;" >virusade</a> </li>
<li><a aria-label="undefined (opens in a new tab)" href="https://www.virustotal.com/gui/" target="_blank" rel="noreferrer noopener" style="color:#0099FF;" >virustotal </a></li>
<li><a aria-label="undefined (opens in a new tab)" href="https://malwareconfig.com/" target="_blank" rel="noreferrer noopener" style="color:#0099FF;" >malware config</a></li>
<li><a aria-label="undefined (opens in a new tab)" href="https://id-ransomware.malwarehunterteam.com/" target="_blank" rel="noreferrer noopener" style="color:#0099FF;" >malware hunter team</a> </li>
<li><a aria-label="undefined (opens in a new tab)" href="http://www.virscan.org" target="_blank" rel="noreferrer noopener" style="color:#0099FF;" >virscan</a>&nbsp; </li>
<li><a href="https://virusscan.jotti.org/it" target="_blank" aria-label="undefined (opens in a new tab)" rel="noreferrer noopener" style="color:#0099FF;" >jotti</a> </li>
</ul>


# Quiz 

#### What is the type of malware that is used to control the device remotely?
>**ANSWER: RAT**
#### What is the name given to programs that translate compiled code into assembly language?
>**ANSWER: Disassemblers**
#### What is the type of malware that is increasing in popularity and encrypts the files on the victim device and demands ransom?
>**ANSWER: Ransomware**
#### What is the name of the malware that has many 0day exploits and targets nuclear power plants that was on the agenda in 2010?
>**ANSWER: Stuxnet**
#### What is the malware analysis method that allows to find the command and control center in a short time?
>**ANSWER: Dynamic Analysis**
#### What is the name given to software that allows programs to be changed at runtime, to direct the flow of the code, to change the registers?
>**ANSWER: Debuggers**
#### What is the function that automatically enables macro codes to be run when the Office document is opened?
>**ANSWER: Workbook_Open()**
#### Which of the following is not a debugger?
>**ANSWER: Python**
#### Which software enables encryption of the codes of the PE file to make static analysis difficult?
>**ANSWER: Packers**
#### Which register is responsible for keeping the return values of functions in x86 architecture?
>**ANSWER: EAX**
# 100% CORRECT