# LECTURE7: How to Investigate a SIEM Alert?
## 1) Introduction to SIEM Alerts
>**ANSWER: CHECK**

## 2) Detection

### SIEM alerts:  
are notifications generated by the SIEM system based on predefined rules 
and correlation algorithms. These rules are typically customized to meet an organization's 
specific security requirements. When an event matches the defined criteria, the SIEM 
system triggers an alert.

### Playbooks: 
There are many different types of alerts (web attacks, ransomware, malware, phishing, etc.) 
in the SOC (Security Operations Centre) environment. The methods and approaches for 
investigating these alerts are different. Workflows for effective and consistent analysis of 
alerts generated by SIEM or other security tools are called playbooks.

### Why Are Playbooks Important?
As SOC analysts, we don't always know the exact steps to take when dealing with alerts. 
Playbooks help by providing a clear, step-by-step process to follow 
during an investigation. This is especially helpful for new analysts just starting their SOC careers.

### Alerts Types:
 * A true positive means that the alert is legitimate and requires further action,  
 * false positive means that the alert is a false alarm.

 #### In which channel can you take ownership of the alert?
 >**ANSWER: main channel**
  #### Once you have completed the analysis of an alert, in which channel can you close the alert?
 >**ANSWER: Investigation channel**

 ## 3) Case Creation and Playbook Initiation

 Creating a case allows us to organize and track our investigation efforts, 
 while the playbook guides us through the necessary steps to effectively respond to the security incident.

 ### lets solve this chapter lab EventID: 257 - SOC282 - Phishing Alert - Deceptive Mail Detected 
 
1. clicking into "Take Ownership button"

![alt text](../Assets/lab7/1.png)
![alt text](../Assets/lab7/2.png)
as we see there is a email phishing alert lets check it closely. 


2. keep playbook in a new tap cause it show us the steps to solve this lab 

![alt text](../Assets/lab7/3.png)

we should answer the playbook Questions 
* When was it sent?
* What is the email's SMTP address?
* What is the sender address?
* What is the recipient address?
* Is the mail content suspicious?
* Are there any attachment?


3. in the alert we have the SMTP Address 

![alt text](../Assets/lab7/1.png)
its 103.80.134.63

4. now we enter the Email Security Section from left bar to check email content 

![alt text](../Assets/lab7/4.png)
![alt text](../Assets/lab7/5.png)
now we have the date that email recived and the content of the mail it has a file and the sender and recipient adresses

5. now lets check if the file that attached is malicious file or not ,so lets download it the password is "infected" 
![alt text](../Assets/lab7/6.png)
after extracting it windows defender shows us that its a malicious file 

![alt text](../Assets/lab7/7.png)
its says the file is a backdoor virus 

and if we upload the file "RECOMMENDED" to [virustotal](https://www.virustotal.com/) its tell us that its malicious software "trojan"

![alt text](../Assets/lab7/9.png)


6. now we have all information we need lets slart closing the alert 

![alt text](../Assets/lab7/8.png)
![alt text](../Assets/lab7/10.png)
![alt text](../Assets/lab7/11.png)


7. lets delete the email from customer mailbox 
![alt text](../Assets/lab7/12.png)

click the delete button and right corner 
![alt text](../Assets/lab7/13.png)

![alt text](../Assets/lab7/14.png)

8. lets contain the user machine!
![alt text](../Assets/lab7/15.png)

9. go to the "EDR" page and contain the user machine!

![alt text](../Assets/lab7/16.png)
go to the "EDR" page and contain the user machine! by searching the victum address "172.16.20.3"

![alt text](../Assets/lab7/17.png)

![alt text](../Assets/lab7/18.png)

![alt text](../Assets/lab7/19.png)
true positive alert !!

### Questions :

#### What is the “type” of the alert?
>**ANSWER: Exchange**
#### When was the alert generated?
>**ANSWER: May, 13, 2024, 09:22 AM**
#### What is the email's SMTP address?
>**ANSWER: 103.80.134.63**
#### What is the source address?
>**ANSWER: free@coffeeshooop.com**
#### What is the destination address?
>**ANSWER: Felix@letsdefend.io**


